@using BMSHPMS.CommonManage.ViewModels.DabeiReceiptVMs
@using BMSHPMS.Models.DabeiDharmaService
@model DabeiReceiptVM
@{
    var dabeiDonorList = Model.DabeiDonorList;
    dabeiDonorList.Add(new DabeiDonor());
}

<style>
    table tr >td input{
        height: 38px;
        line-height: 1.3;
        line-height: 38px;
        border-width: 1px;
        border-style: solid;
        background-color: #fff;
        border-color: #eee;
        border-radius: 2px;
        margin:5px;
    }

    table {
        margin-left:20px;
    }

    #btnAddNew{
        margin-left:20px;
    }
</style>

<wt:form vm="@Model">
    <wt:row items-per-row="ItemsPerRowEnum.Two">
        <wt:textbox field="Entity.ReceiptNumber" />
        <wt:textbox field="Entity.ContactName" />
        <wt:textbox field="Entity.Phone" />
    </wt:row>
    <hr />
    <div>
        <table>
            <thead>
                <tr>
                    <td>功德芳名</td>
                    <td>金額</td>
                </tr>
            </thead>
            <tbody id="tbbody">
                @for (int i = 0; i < dabeiDonorList.Count; i++)
                {
                    <tr>
                        <td>
                            <input asp-for="@dabeiDonorList[i].Name" />
                        </td>
                        <td>
                            <input asp-for="@dabeiDonorList[i].Sum" />
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <hr />
    <div>
        <button type="button" id="btnAddNew" class="layui-btn" >新增功德芳名</button>
    </div>
    <hr />
    <wt:row align="AlignEnum.Right">
        <wt:submitbutton />
        <wt:closebutton />
    </wt:row>
</wt:form>

<script>
    (function () {
        $("#btnAddNew").click(function () {
            var count = $("#tbbody >tr").length;
            $("#tbbody").append(`<tr><td><input type="text" name="dabeiDonorList[${count}].Name"></td>
                                     <td><input type="number" name="dabeiDonorList[${count}].Sum"></td>
                                         <td><button class="btnremove layui-btn layui-btn-sm">移除</button></td>
                                 </tr>`);

            AddRemoveAction();
        });

        function AddRemoveAction() {
            $(".btnremove").each(function (index, item) {
                $(item).click(function () {
                    $(this).closest('tr').remove();
                });

            })
        }
    })();
</script>
